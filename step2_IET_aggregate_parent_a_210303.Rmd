---
title: "Modeling Indoor Heat Health Impact Step 2 Aggregate IET by Day"
author: "Carina Gronlund"
date: "March 3, 2021"
output:
  html_document:
    df_print: paged
editor_options:
  chunk_output_type: inline
---

```{r chunk-setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE, eval=T, cache=F)
```

Libraries and master workspace.
```{r libs, eval=T}
library(data.table)
source('C:\\Users\\gronlund\\Box Sync\\DocumentsC\\NSF Stone\\Health Impact Function\\Programs\\paths_filenames.R', local = knitr::knit_global())
load(paste0(pa2,fi2))
```

#Step 2: Aggregate Hourly IET by Day
This step uses large IET data sets, one per city per period per heatwave period (during or post), provided by Dave Hondula, that contain an IET for each synthetic person in a city for each hour for each day in hw.periods. We loop through each scenario so that we're not trying to hold multiple multi-gigabyte hourly files in the R workspace, which R would not allow.

```{r chunk-run-step3a-scenarios, results='asis'}
res<-list()
for (city in fullcity) {
  fs1<-grep(city,IET.input.filenames.step3a,value=T)
  cy<-abbrcity[match(city,fullcity)] #abbreviated city
  fs2<-gsub('_','\\.',gsub('HourlyIETRun_','',gsub('Nov30.csv','',fs1)))
  res<-c(res,list(knitr::knit_child('step2_IET_aggregate_child_a_210303.Rmd', quiet=T, envir=environment())))
}
cat(unlist(res),'\n')
```


